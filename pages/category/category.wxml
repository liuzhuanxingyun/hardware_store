<!--pages/category/category.wxml-->
<view class="container-category">
  <navigation-bar title="全部分类" back="{{false}}" background="#fff"></navigation-bar>
  
  <view class="content-wrapper">
    <!-- 左侧侧边栏 -->
    <scroll-view scroll-y class="left-sidebar">
      <block wx:for="{{categories}}" wx:key="id">
        <view 
          class="sidebar-item {{currentTab === index ? 'active' : ''}}" 
          bindtap="onTabTap" 
          data-index="{{index}}">
          <view class="sidebar-text">{{item.name}}</view>
          <view class="active-line" wx:if="{{currentTab === index}}"></view>
        </view>
      </block>
    </scroll-view>

    <!-- 右侧内容区 -->
    <scroll-view scroll-y class="right-content">
      <view class="category-banner">
        <image src="/images/home1.jpg" mode="aspectFill"></image>
      </view>
      
      <view class="section-title">
        <!-- 增加判断，防止数组越界报错 -->
        <text wx:if="{{categories[currentTab]}}">{{categories[currentTab].name}}</text>
      </view>

      <view class="grid-list">
        <!-- 修改：遍历 currentGoodsList -->
        <block wx:for="{{currentGoodsList}}" wx:key="id">
          <view class="grid-item" bindtap="onItemTap" data-id="{{item.id}}">
            <!-- 修改：图片字段改为 item.img -->
            <image class="item-img" src="{{item.img}}" mode="aspectFit"></image>
            <text class="item-name">{{item.name}}</text>
          </view>
        </block>
        
        <!-- 空状态提示 -->
        <view wx:if="{{currentGoodsList.length === 0}}" style="text-align: center; color: #999; padding: 20px;">
          <text>暂无商品</text>
        </view>
      </view>
    </scroll-view>
  </view>
</view>